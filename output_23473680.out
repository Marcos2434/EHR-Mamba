Defaulting to user installation because normal site-packages is not writeable
Looking in indexes: https://pypi.org/simple, https://download.pytorch.org/whl/cu118
Collecting torch==2.2.0 (from -r requirements.txt (line 2))
  Downloading https://download.pytorch.org/whl/cu118/torch-2.2.0%2Bcu118-cp39-cp39-linux_x86_64.whl (811.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 811.7/811.7 MB 1.3 MB/s eta 0:00:00
Requirement already satisfied: numpy==1.25.1 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 3)) (1.25.1)
Requirement already satisfied: tqdm==4.66.2 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 4)) (4.66.2)
Requirement already satisfied: pandas==1.1.4 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 5)) (1.1.4)
Requirement already satisfied: h5py==3.12.1 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 6)) (3.12.1)
Requirement already satisfied: matplotlib==3.8.2 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 7)) (3.8.2)
Requirement already satisfied: matplotlib-inline==0.1.7 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 8)) (0.1.7)
Requirement already satisfied: click==8.1.7 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 9)) (8.1.7)
Requirement already satisfied: scikit-learn==0.24.2 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 10)) (0.24.2)
Requirement already satisfied: x-transformers==1.16.23 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from -r requirements.txt (line 11)) (1.16.23)
Requirement already satisfied: filelock in /appl9/python/3.9.19/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (3.15.4)
Requirement already satisfied: typing-extensions>=4.8.0 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (4.12.2)
Requirement already satisfied: sympy in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (1.13.3)
Requirement already satisfied: networkx in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (3.2.1)
Requirement already satisfied: jinja2 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (3.1.4)
Requirement already satisfied: fsspec in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (2024.10.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.8.89 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (11.8.89)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.8.89 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (11.8.89)
Requirement already satisfied: nvidia-cuda-cupti-cu11==11.8.87 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (11.8.87)
Requirement already satisfied: nvidia-cudnn-cu11==8.7.0.84 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (8.7.0.84)
Requirement already satisfied: nvidia-cublas-cu11==11.11.3.6 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (11.11.3.6)
Requirement already satisfied: nvidia-cufft-cu11==10.9.0.58 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (10.9.0.58)
Requirement already satisfied: nvidia-curand-cu11==10.3.0.86 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (10.3.0.86)
Requirement already satisfied: nvidia-cusolver-cu11==11.4.1.48 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (11.4.1.48)
Requirement already satisfied: nvidia-cusparse-cu11==11.7.5.86 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (11.7.5.86)
Requirement already satisfied: nvidia-nccl-cu11==2.19.3 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (2.19.3)
Requirement already satisfied: nvidia-nvtx-cu11==11.8.86 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from torch==2.2.0->-r requirements.txt (line 2)) (11.8.86)
Collecting triton==2.2.0 (from torch==2.2.0->-r requirements.txt (line 2))
  Downloading https://download.pytorch.org/whl/triton-2.2.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (167.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 167.9/167.9 MB 6.0 MB/s eta 0:00:00
Requirement already satisfied: python-dateutil>=2.7.3 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from pandas==1.1.4->-r requirements.txt (line 5)) (2.9.0.post0)
Requirement already satisfied: pytz>=2017.2 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from pandas==1.1.4->-r requirements.txt (line 5)) (2024.2)
Requirement already satisfied: contourpy>=1.0.1 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib==3.8.2->-r requirements.txt (line 7)) (1.3.0)
Requirement already satisfied: cycler>=0.10 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib==3.8.2->-r requirements.txt (line 7)) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib==3.8.2->-r requirements.txt (line 7)) (4.54.1)
Requirement already satisfied: kiwisolver>=1.3.1 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib==3.8.2->-r requirements.txt (line 7)) (1.4.7)
Requirement already satisfied: packaging>=20.0 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib==3.8.2->-r requirements.txt (line 7)) (24.2)
Requirement already satisfied: pillow>=8 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib==3.8.2->-r requirements.txt (line 7)) (11.0.0)
Requirement already satisfied: pyparsing>=2.3.1 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib==3.8.2->-r requirements.txt (line 7)) (3.2.0)
Requirement already satisfied: importlib-resources>=3.2.0 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib==3.8.2->-r requirements.txt (line 7)) (6.4.5)
Requirement already satisfied: traitlets in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from matplotlib-inline==0.1.7->-r requirements.txt (line 8)) (5.14.3)
Requirement already satisfied: scipy>=0.19.1 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from scikit-learn==0.24.2->-r requirements.txt (line 10)) (1.13.1)
Requirement already satisfied: joblib>=0.11 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from scikit-learn==0.24.2->-r requirements.txt (line 10)) (1.4.2)
Requirement already satisfied: threadpoolctl>=2.0.0 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from scikit-learn==0.24.2->-r requirements.txt (line 10)) (3.5.0)
Requirement already satisfied: einops>=0.6.1 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from x-transformers==1.16.23->-r requirements.txt (line 11)) (0.8.0)
Requirement already satisfied: zipp>=3.1.0 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from importlib-resources>=3.2.0->matplotlib==3.8.2->-r requirements.txt (line 7)) (3.21.0)
Requirement already satisfied: six>=1.5 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from python-dateutil>=2.7.3->pandas==1.1.4->-r requirements.txt (line 5)) (1.16.0)
Requirement already satisfied: MarkupSafe>=2.0 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from jinja2->torch==2.2.0->-r requirements.txt (line 2)) (3.0.2)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (from sympy->torch==2.2.0->-r requirements.txt (line 2)) (1.3.0)
Installing collected packages: triton, torch
  Attempting uninstall: triton
    Found existing installation: triton 3.0.0
    Uninstalling triton-3.0.0:
      Successfully uninstalled triton-3.0.0
  Attempting uninstall: torch
    Found existing installation: torch 2.4.0+cu121
    Uninstalling torch-2.4.0+cu121:
      Successfully uninstalled torch-2.4.0+cu121
Successfully installed torch-2.2.0+cu118 triton-2.2.0
Defaulting to user installation because normal site-packages is not writeable
Looking in indexes: https://pypi.org/simple, https://data.pyg.org/whl/torch-2.2.0+cu118.html
Requirement already satisfied: torch_scatter in /zhome/c4/0/168981/.local/lib/python3.9/site-packages (2.1.2)
Error importing huggingface_hub.hf_api: No module named 'urllib3'

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 23473680: <mamba_training_1> in cluster <dcc> Exited

Job <mamba_training_1> was submitted from host <hpclogin1> by user <s215210> in cluster <dcc> at Wed Dec 18 14:50:02 2024
Job was executed on host(s) <4*n-62-28-31>, in queue <hpc>, as user <s215210> in cluster <dcc> at Wed Dec 18 14:50:02 2024
</zhome/c4/0/168981> was used as the home directory.
</dtu/blackhole/15/168981/EHR-Mamba> was used as the working directory.
Started at Wed Dec 18 14:50:02 2024
Terminated at Wed Dec 18 14:53:13 2024
Results reported at Wed Dec 18 14:53:13 2024

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/bash
#BSUB -q hpc             # Specify the queue
#BSUB -J mamba_training_1  # Job name
#BSUB -n 4               # Number of cores
#BSUB -R "rusage[mem=8GB]"  # Memory per core
#BSUB -W 48:00           # Walltime limit (hh:mm)
#BSUB -o output_%J.out   # Standard output file
#BSUB -e error_%J.err    # Standard error file

# Load necessary modules
module load python3/3.9.19 # Load the appropriate Python module
module load cuda/11.8
module load cudnn/v8.8.0-prod-cuda-11.X
# Load other modules if necessary
pip install -r requirements.txt
pip install torch_scatter --extra-index-url https://data.pyg.org/whl/torch-2.2.0+cu118.html

# Activate virtual environment if applicable
# source /path/to/venv/bin/activate

# Navigate to the script directory
cd /dtu/blackhole/15/168981/EHR-Mamba

# Run your Python script with the desired arguments
python cli.py --output_path=output-mamba-181431 --model_type=simple_mamba --epochs=120 --batch_size=32 --lr=0.001
------------------------------------------------------------

Exited with exit code 1.

Resource usage summary:

    CPU time :                                   42.58 sec.
    Max Memory :                                 153 MB
    Average Memory :                             137.75 MB
    Total Requested Memory :                     32768.00 MB
    Delta Memory :                               32615.00 MB
    Max Swap :                                   -
    Max Processes :                              4
    Max Threads :                                6
    Run time :                                   233 sec.
    Turnaround time :                            191 sec.

The output (if any) is above this job summary.



PS:

Read file <error_23473680.err> for stderr output of this job.

